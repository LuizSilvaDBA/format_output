# Overview
Quite often I need to query data using the DB2 clp on Linux and it's very difficult to read rows that are too large in width. To make it worse, sometimes (VAR)CHAR columns are defined with a big length but have actually small values, causing a lot of spaces to be displayed.

As a solution I wrote this short AWK script that dynamically formats the SQL output (you can actually use it for any similar command's output) into fixed columns, based on the maximum length of each column.

It relies on the column headings to figure out the max possible column width, so don't use option -x at the Db2 clp to supress it.

# Usage
Copy the script to $HOME/bin or to other preferred location and setup your PATH accordingly.
```bash
db2 "select * from <table>" | format.awk
```

# Examples

Regular out in DB2 clp:
```bash
$ db2 "select * from syscat.tables where tabschema = 'SYSIBM' and type = 'T' order by tabname fetch first 10 rows only" | format.awk
Number of columns: 85
Column sizes: 9 18 6 9 4 6 14 12 13 11 26 26 26 26 8 7 9 4 6 6 6 11 6 9 8 11 13 12 7 8 8 10 10 9 10 11 32 7 14 13 7 11 7 12 8 8 10 8 18 11 11 11 9 13 8 18 20 22 10 17 13 8 15 13 23 21 15 13 26 11 21 13 15 21 7 8 6 10 10 7 12 8 17 15 7
TABSCHEMA|           TABNAME| OWNER|OWNERTYPE|TYPE|STATUS|BASE_TABSCHEMA|BASE_TABNAME|ROWTYPESCHEMA|ROWTYPENAME|               CREATE_TIME|                ALTER_TIME|           INVALIDATE_TIME|                STATS_TIME|COLCOUNT|TABLEID|TBSPACEID|CARD|NPAGES|MPAGES|FPAGES|NPARTITIONS|NFILES|TABLESIZE|OVERFLOW|    TBSPACE|INDEX_TBSPACE|LONG_TBSPACE|PARENTS|CHILDREN|SELFREFS|KEYCOLUMNS|KEYINDEXID|KEYUNIQUE|CHECKCOUNT|DATACAPTURE|                   CONST_CHECKED|PMAP_ID|PARTITION_MODE|LOG_ATTRIBUTE|PCTFREE|APPEND_MODE|REFRESH|REFRESH_TIME|LOCKSIZE|VOLATILE|ROW_FORMAT|PROPERTY|STATISTICS_PROFILE|COMPRESSION|ROWCOMPMODE|ACCESS_MODE|CLUSTERED|ACTIVE_BLOCKS|DROPRULE|MAXFREESPACESEARCH|AVGCOMPRESSEDROWSIZE|AVGROWCOMPRESSIONRATIO|AVGROWSIZE|PCTROWSCOMPRESSED|LOGINDEXBUILD|CODEPAGE|COLLATIONSCHEMA|COLLATIONNAME|COLLATIONSCHEMA_ORDERBY|COLLATIONNAME_ORDERBY|ENCODING_SCHEME|PCTPAGESSAVED|           LAST_REGEN_TIME|SECPOLICYID|PROTECTIONGRANULARITY|AUDITPOLICYID|AUDITPOLICYNAME|AUDITEXCEPTIONENABLED|DEFINER|ONCOMMIT|LOGGED|ONROLLBACK|  LASTUSED|CONTROL|TEMPORALTYPE|TABLEORG|EXTENDED_ROW_SIZE|PCTEXTENDEDROWS|REMARKS|
         |                  |      |         |    |      |              |            |             |           |                          |                          |                          |                          |        |       |         |    |      |      |      |           |      |         |        |           |             |            |       |        |        |          |          |         |          |           |                                |       |              |             |       |           |       |            |        |        |          |        |                  |           |           |           |         |             |        |                  |                    |                      |          |                 |             |        |               |             |                       |                     |               |             |                          |           |                     |             |               |                     |       |        |      |          |          |       |            |        |                 |               |       |
   SYSIBM|     SYSATTRIBUTES|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.25.523075|      27|     45|        0|  35|     1|     0|     1|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|       176|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |01/01/0001|       |           N|       R|                N|  -1.00000E+000|      -|
   SYSIBM|SYSAUDITEXCEPTIONS|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.25.673913|       9|    171|        0|   0|     0|     0|     1|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|         0|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |01/01/0001|       |           N|       R|                N|  -1.00000E+000|      -|
   SYSIBM|  SYSAUDITPOLICIES|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.25.802575|      14|    157|        0|   0|     0|     0|     1|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|         0|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |07/10/2019|       |           N|       R|                N|  -1.00000E+000|      -|
   SYSIBM|       SYSAUDITUSE|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.25.980571|       5|    156|        0|   0|     0|     0|     1|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|         0|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |01/01/0001|       |           N|       R|                N|  -1.00000E+000|      -|
   SYSIBM|SYSBUFFERPOOLNODES|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.26.106812|       3|     44|        0|   0|     0|     0|     1|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|         0|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |01/01/0001|       |           N|       R|                N|  -1.00000E+000|      -|
   SYSIBM|    SYSBUFFERPOOLS|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.26.270943|       7|     43|        0|  13|     1|     0|     1|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|        47|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |07/07/2019|       |           N|       R|                N|  -1.00000E+000|      -|
   SYSIBM|         SYSCHECKS|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.26.445146|      15|     26|        0|   2|     1|     0|     1|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|       269|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |07/10/2019|       |           N|       R|                N|  -1.00000E+000|      -|
   SYSIBM| SYSCODEPROPERTIES|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.26.579654|      11|    101|        0| 266|     5|     0|     5|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|       128|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |07/09/2019|       |           N|       R|                N|  -1.00000E+000|      -|
   SYSIBM|        SYSCOLAUTH|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.26.720570|      12|     36|        0|   0|     0|     0|     1|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|         0|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |07/10/2019|       |           N|       R|                N|  -1.00000E+000|      -|
   SYSIBM|      SYSCOLCHECKS|SYSIBM|        S|   T|     N|             -|           -|            -|          -|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-17-10.01.00.075393|2019-06-27-17.29.26.862709|       5|     27|        0|   6|     1|     0|     1|         -1|    -1|       -1|       0|SYSCATSPACE|            -|           -|      0|       0|       0|         0|         0|        0|         0|          N|YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY|      0|              |            0|     -1|          N|       |           -|       R|        |         N|        |                 -|          N|           |          F|        -|            0|        |               999|                   0|         +0.00000E+000|        87|    +0.00000E+000|            -|    1208|         SYSIBM|     IDENTITY|                 SYSIBM|             IDENTITY|               |            0|2019-06-17-10.01.00.075393|          0|                     |            -|              -|                    N| SYSIBM|        |      |          |06/26/2019|       |           N|       R|                N|  -1.00000E+000|      -|
         |                  |      |         |    |      |              |            |             |           |                          |                          |                          |                          |        |       |         |    |      |      |      |           |      |         |        |           |             |            |       |        |        |          |          |         |          |           |                                |       |              |             |       |           |       |            |        |        |          |        |                  |           |           |           |         |             |        |                  |                    |                      |          |                 |             |        |               |             |                       |                     |               |             |                          |           |                     |             |               |                     |       |        |      |          |          |       |            |        |                 |               |       |
         |                  |      |         |    |      |              |            |             |           |                          |                          |                          |                          |        |       |         |    |      |      |      |           |      |         |        |           |             |            |       |        |        |          |          |         |          |           |                                |       |              |             |       |           |       |            |        |        |          |        |                  |           |           |           |         |             |        |                  |                    |                      |          |                 |             |        |               |             |                       |                     |               |             |                          |           |                     |             |               |                     |       |        |      |          |          |       |            |        |                 |               |       |
         |                  |      |         |    |      |              |            |             |           |                          |                          |                          |                          |        |       |         |    |      |      |      |           |      |         |        |           |             |            |       |        |        |          |          |         |          |           |                                |       |              |             |       |           |       |            |        |        |          |        |                  |           |           |           |         |             |        |                  |                    |                      |          |                 |             |        |               |             |                       |                     |               |             |                          |           |                     |             |               |                     |       |        |      |          |          |       |            |        |                 |               |       |
  10 record(s) selected.
$  
```
